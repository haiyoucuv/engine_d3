{"version":3,"file":"engine.js","sources":["../src/ui/BaseObject.ts","../src/ui/Group.ts","../src/ui/Image.ts","../src/runtime/Stage.ts","../src/runtime/Game.ts","../src/runtime/Scene.ts"],"sourcesContent":["/*\n * Created by 还有醋v on 2020/5/13.\n * Copyright © 2020 haiyoucuv. All rights reserved.\n */\n\nexport class BaseObject {\n\n    public entity;\n\n    public style: CSSStyleDeclaration;\n\n\n    /** public **/\n    public children: BaseObject[] = [];\n\n    /** protected **/\n    protected _name: string = '';\n    protected _parent: BaseObject = null;\n    protected _x: number = 0;\n    protected _y: number = 0;\n    protected _width: number = 0;\n    protected _height: number = 0;\n\n    constructor() {\n\n    }\n\n    /**\n     * life\n     * @private\n     */\n    protected init() {\n        this.style = this.entity.style;\n        this.style.position = 'absolute';\n    }\n\n    protected start() {\n\n    }\n\n\n    update(dt) {\n        this.children.forEach(v => v.update(dt));\n    }\n\n    protected afterUpdate(dt) {\n        this.children.forEach(v => v.afterUpdate(dt));\n    }\n\n    protected destroy() {\n\n    }\n\n    public hasChild(): boolean {\n        return this.children.length > 0;\n    }\n\n    /**\n     * 添加一个子节点\n     * 可能需要子类重写\n     * @param {BaseObject} child\n     */\n    public addChild(child: BaseObject) {\n        if(child.parent) {\n            throw \"这个child已经有parent了\";\n        }\n        if(this.children.length > 0) {\n            this.entity.insertBefore(child.entity, this.children[0].entity);\n        } else {\n            this.entity.appendChild(child.entity);\n        }\n        this.children.unshift(child);\n    }\n\n    /**\n     * 移除一个子节点\n     * 可能需要子类重写\n     * @param {BaseObject} child\n     */\n    public removeChild(child: BaseObject) {\n        if(child.parent != this) {\n            throw \"这个child的parent不是它\";\n        }\n        this.entity.removeChild(child);\n    }\n\n    /**\n     * name\n     * @param {string} name\n     */\n    public set name(name: string) {\n        this._name = name;\n    }\n\n    public get name(): string {\n        return this._name;\n    }\n\n    /**\n     * parent\n     * @returns {BaseObject}\n     */\n    public get parent(): BaseObject {\n        return this._parent;\n    }\n\n    public set parent(parent: BaseObject) {\n        parent.addChild(this);\n    }\n\n    /**\n     * position\n     * @param {number} x\n     */\n    public set x(x: number) {\n        this._x = x;\n        this.style.left = x + 'px';\n    }\n\n    public get x(): number {\n        return this._x;\n    }\n\n    public set y(y: number) {\n        this._y = y;\n        this.style.top = y + 'px';\n    }\n\n    public get y(): number {\n        return this._y;\n    }\n\n    /**\n     * size\n     * @param {number} width\n     */\n    public set width(width: number) {\n        this._width = width;\n        this.style.width = width + 'px';\n    }\n\n    public get width(): number {\n        return this._width;\n    }\n\n    public set height(height: number) {\n        this._height = height;\n        this.style.height = height + 'px';\n    }\n\n    public get height(): number {\n        return this._height;\n    }\n\n}\n","/*\n * Created by 还有醋v on 2020/5/13.\n * Copyright © 2020 haiyoucuv. All rights reserved.\n */\n\n\nimport { BaseObject } from \"./BaseObject\";\n\nexport class Group extends BaseObject {\n\n    constructor() {\n        super();\n        this.entity = document.createElement('div');\n        this.init();\n    }\n\n}\n","/*\n * Created by 还有醋v on 2020/5/13.\n * Copyright © 2020 haiyoucuv. All rights reserved.\n */\n\nimport { Group } from \"./Group\";\n\nexport class Image extends Group {\n\n    public img;\n\n    constructor() {\n        super();\n        this.img = new window.Image();\n\n        this.entity.appendChild(this.img);\n    }\n\n    public set width(width: number) {\n        this._width = width;\n        this.style.width = width + 'px';\n        this.img.width = width;\n    }\n\n    public get width(): number {\n        return this._width;\n    }\n\n    public set height(height: number) {\n        this._height = height;\n        this.style.height = height + 'px';\n        this.img.height = height;\n    }\n\n    public get height(): number {\n        return this._height;\n    }\n\n    public set src(src: string) {\n        this.img.src = src;\n    }\n\n    public get src(): string {\n        return this.img.src;\n    }\n}\n","/*\n * Created by 还有醋v on 2020/5/13.\n * Copyright © 2020 haiyoucuv. All rights reserved.\n */\n\nimport { Group } from \"../ui/Group\";\n\nexport class Stage extends Group {\n\n    constructor() {\n        super();\n    }\n\n}\n","/*\n * Created by 还有醋v on 2020/5/13.\n * Copyright © 2020 haiyoucuv. All rights reserved.\n */\n\nimport { Stage } from \"./Stage\";\n\n/**\n * Game 游戏实例\n */\nexport class Game {\n\n    public name: string = 'Game';\n\n    public gameStage = new Stage();\n    public style = this.gameStage.style;\n\n    constructor() {\n        this.gameStage.style.position = 'absolute';\n        this.gameStage.width = document.documentElement.clientWidth;\n        this.gameStage.height = document.documentElement.clientHeight;\n\n        document.body.appendChild(this.gameStage.entity);\n\n        this.update();\n    }\n\n    public addChild(child) {\n        this.gameStage.addChild(child);\n    }\n\n    public removeChild(child) {\n        this.gameStage.removeChild(child);\n    }\n\n    private _lastTime = Date.now();\n    private fps = 0;\n\n    /**\n     * update\n     */\n    public update() {\n        let dt = (Date.now() - this._lastTime) / 1000;\n        this.fps = ~~(1 / dt);\n        this.gameStage.children.forEach(v => v.update(dt));\n        this._lastTime = Date.now();\n        requestAnimationFrame(this.update.bind(this));\n    }\n\n}\n","/*\n * Created by 还有醋v on 2020/5/13.\n * Copyright © 2020 haiyoucuv. All rights reserved.\n */\n\n\nexport class Scene {\n    constructor() {\n\n    }\n}\n"],"names":["tslib_1.__extends"],"mappings":"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"}